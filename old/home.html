<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>
            Dashboard
        </title>
        <link rel="stylesheet" type="text/css" href="leaflet.awesome-markers.css">
        <link rel="stylesheet" type="text/css" href="styles.css">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
        integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
        crossorigin=""/>
        <script src="https://kit.fontawesome.com/f0405aa146.js" crossorigin="anonymous"></script>
        <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
       integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
       crossorigin=""></script>
       <script src="leaflet.awesome-markers.js"></script>
       <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <style>
      #checkinMap { height: 180px;
      margin:8px 0px; }
      #map {
          height: 400px;
      }
            #mymap {position: absolute;top:80px;bottom: 0;left: 0;right: 400px;}
        </style>
         <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
         <script
         src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBBlArqoiKIjtdTSju_7x9bfcyxGvl6hFA&callback=initMap&libraries=&v=weekly"
         defer
       ></script>
       
    </head>
<body class="hero-anime">	

	<div class="navigation-wrap bg-light start-header start-style">
		<div class="container">
			<div class="row">
				<div class="col-12">
					<nav class="navbar navbar-expand-md navbar-light">
                        <div>
                            <a class="logo">Logo</a>
                        </div>						
						<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
							<span class="navbar-toggler-icon"></span>
						</button>
						
						<div class="collapse navbar-collapse" id="navbarSupportedContent">
							<ul class="navbar-nav ml-auto py-4 py-md-0">
								<li class="nav-item pl-4 pl-md-0 ml-0 ml-md-4 active">
									<a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Home</a>
								</li>
								<li class="nav-item pl-4 pl-md-0 ml-0 ml-md-4">
									<a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">City</a>
									<div class="dropdown-menu">
										<a class="dropdown-item" href="#">Enter Coodinates</a>
										<a class="dropdown-item" href="#">Search</a>
									</div>
                                </li>
                                <li class="nav-item pl-4 pl-md-0 ml-0 ml-md-4">
									<a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Weather Forecast</a>
									<div class="dropdown-menu">
										<a class="dropdown-item" href="#">Enter Coodinates</a>
										<a class="dropdown-item" href="#">Search</a>
									</div>
								</li>
								<li class="nav-item pl-4 pl-md-0 ml-0 ml-md-4">
									<a class="nav-link" href="login.html">Login/Register</a>
								</li>
								<li class="nav-item pl-4 pl-md-0 ml-0 ml-md-4">
									<a class="nav-link" href="#section">About Us</a>
                                </li>
                                <!-- <li class="nav-item pl-4 pl-md-0 ml-0 ml-md-4">
                                    <div class="section mt-5">
                                        <div class="container">
                                            <div class="row">
                                                <div class="col-12">
                                                    <div id="switch">
                                                        <div id="circle"></div>
                                                    </div>
                                                </div>	
                                            </div>		
                                        </div>			
                                    </div>
                                </li> -->
							</ul>
						</div>
					</nav>		
				</div>
			</div>
		</div>
	</div>
	<div class="my-5 py-5">
    </div>
    

    <div id="mymap"   ></div>

    <div class="right"> 
        <!-- <form> -->
        <div class="form-group">
          <label for="exampleInputEmail1">Enter your city</label>
          <input type="text" class="form-control" id="city" aria-describedby="emailHelp" placeholder="Enter city">
          <label for="exampleInputEmail1">Enter your State</label>
          <input type="text" class="form-control" id="state" aria-describedby="emailHelp" placeholder="Enter city">
          <label for="exampleInputEmail1">Enter your Country</label>
          <input type="text" class="form-control" id="country" aria-describedby="emailHelp" placeholder="Enter city">
          <small id="emailHelp" class="form-text text-muted">Check the AQI of your City.<span id="temperature"></span></small>
          <small id="emailHelp" class="form-text text-muted">Check the AQI of your City. this is my line<span id="temperature"></span></small>
         
        </div>
        
     
        <button id="submit" type="submit" class="btn btn-primary" >Submit</button>
        
        <!-- <button type="submit" class="btn btn-primary">My Location</button> -->
   
    </div>
<!-- </form> -->
<script src="./country.js"></script>
<script>      

// var locations=[
// ["Mumbai", 18.9667,72.8333],
// ["Delhi", 28.7,77.2],
// ["Jaipur",26.9167,	75.8667]
// ];
//  var map = L.map('map').setView([22.805, 82.0], 5);
//         L.tileLayer('https://api.maptiler.com/maps/streets/256/{z}/{x}/{y}.png?key=II7uREndG4cP3ocP64ZH', {
//             attribution: '<a href="https://www.maptiler.com/copyright/" target="_blank">&copy; MapTiler</a> <a href="https://www.openstreetmap.org/copyright" target="_blank">&copy; OpenStreetMap contributors</a>',
//         }).addTo(map);

// for (var i = 0; i < locations.length; i++) {
//     marker =  L.marker([locations[i][1], locations[i][2]])
//     .bindPopup(locations[i][0])
// 	.addTo(map);
//var marker = L.marker([18.9667,72.8333]).addTo(map);
</script>
<script >

    let city, country,air,weather;
    async function country_api(){
      // lat = position.coords.latitude;
      //   lon = position.coords.longitude;
        city = document.getElementById('city').value;
        state=document.getElementById('state').value;
        country= document.getElementById('country').value;
        // const api_url=`https://api.weatherbit.io/v2.0/current/airquality?lat=${lat}&lon=${lon}&key=c39e8bc08f7f42769ff7af360eb0cfd7`;
        const api_url = `weather1/${city},${state},${country}`;
        const response = await fetch(api_url);
        const json = await response.json();
        console.log('sdfsd', json);
        weather =json.weather ;
         //air = json.air_quality.results[0].measurements[0];
      // document.getElementById('summary').textContent = json.data[0].aqi;
      document.getElementById('temperature').textContent = weather.data[0].aqi;
      // document.getElementById('aq_parameter').textContent = air.parameter;
      // document.getElementById('aq_value').textContent = air.value;
      // document.getElementById('aq_unit').textContent = air.unit;
      // document.getElementById('aq_date').textContent = air.lastUpdated;
      const data={weather};
      const options = {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(data)
      };  
      const db_response = await fetch('/api_country', options);
      const db_json = await db_response.json();
      getData();
    };
    
    document.getElementById('submit').addEventListener('click',country_api);
    // if ('geolocation' in navigator) {
    //   // console.log('geolocation available');
    //   navigator.geolocation.getCurrentPosition(async position => {
    //     try{
        
    
 

    //   // console.log(json);
      
    //   console.log(json);
    //     }catch(error){
    //        // console.error(error);
    //       console.log('something went wrong');
    //       air={value:-1};
    //       document.getElementById('aq_value').textContent='NO DATA'
    //     }
    //     const data = { lat, lon,weather,air };
    //   const options = {
    //     method: 'POST',
    //     headers: {
    //       'Content-Type': 'application/json'
    //     },
    //     body: JSON.stringify(data)
    //   };
    //   const db_response = await fetch('/api', options);
    //   const db_json = await db_response.json();
    //   console.log(db_json);
    //   });
    // } else {
    //   console.log('geolocation not available');
    // }
    
  </script>
<script>
    (function($) { "use strict";
    
        $(function() {
            var header = $(".start-style");
            $(window).scroll(function() {    
                var scroll = $(window).scrollTop();
            
                if (scroll >= 10) {
                    header.removeClass('start-style').addClass("scroll-on");
                } else {
                    header.removeClass("scroll-on").addClass('start-style');
                }
            });
        });		
            
        //Animation
        
        $(document).ready(function() {
            $('body.hero-anime').removeClass('hero-anime');
        });
    
        //Menu On Hover
            
        $('body').on('mouseenter mouseleave','.nav-item',function(e){
                if ($(window).width() > 750) {
                    var _d=$(e.target).closest('.nav-item');_d.addClass('show');
                    setTimeout(function(){
                    _d[_d.is(':hover')?'addClass':'removeClass']('show');
                    },1);
                }
        });	
        
        //Switch light/dark
        
        $("#switch").on('click', function () {
            if ($("body").hasClass("dark")) {
                $("body").removeClass("dark");
                $("#switch").removeClass("switched");
            }
            else {
                $("body").addClass("dark");
                $("#switch").addClass("switched");
            }
        });  
        
      })(jQuery);
  
  </script>   

 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
  
</body>

</html>



